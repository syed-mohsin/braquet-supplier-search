<section class="list-view" ng-controller="CatalogController">
    <img src="/modules/core/client/img/loaders/loader.gif" style="display: block; margin:0 auto;" ng-if="resolvedResources !== expectedResources">
    <div id="catalog-page" ng-show="resolvedResources === expectedResources">
        <div class="page-header">
            <div class="row">
                <h4 class="side-title col-md-3"><b>Best module suppliers</b></h4>
                <div class="col-md-9 search extend">
                    <form ng-submit="searchSubmit()">
                        <input class="form-control col-md-12" type="text" ng-model="search" placeholder="Search for solar suppliers" />
                        <button type="submit" class="btn btn-primary submit">Submit</button>
                    </form>
                </div>
            </div>
        </div>
        <section>
            <div class="menu">
                <button class="visible-xs btn-primary last" ng-click="toggleFilter()" data-toggle="collapse" data-target="side-navbar">See Filters</button>
                <button ng-if="false" class="btn-primary last" ng-click="sortBy()" data-target="side-navbar">Sort By Price</button>
            </div>
            <div class="col-sm-3 side-navbar {{hiddenFilterClass}}" id="side-navbar">
                <label>Filters</label>

                <div class="list-group quantity-filter">
                    <span class="catalog-label"><small>Quantity ></small></span>
                    <li ng-repeat="quant in quantities">
                        <label><input type="radio" name="quantity" ng-model="$parent.quantity" ng-value="quant" analytics-on="click" analytics-event="Click Quantity Filter: {{$parent.quantity}}" ng-change="updateFilter()" /> <small>{{quant}}</small></label><br>
                    </li>
                </div>

                <div class="list-group">
                    <span class="catalog-label"><small>Supplier Type ></small></span>
                    <li>
                      <label>
                        <input type="checkbox" ng-model="isman" analytics-on="click" analytics-event="Click Manufacturer Only Filter: {{!isman}}" ng-change="updateFilter()">
                        <span><small>Manufacturers</small></span>
                      </label>
                    </li>
                    <li>
                      <label>
                        <input type="checkbox" ng-model="isreseller" analytics-on="click" analytics-event="Click Reseller Only Filter: {{!isreseller}}" ng-change="updateFilter()">
                        <span><small>Resellers</small></span>
                      </label>
                    </li>
                </div>

                <div class="list-group">
                    <span class="catalog-label"><small>Technology Type ></small></span>
                    <li ng-repeat="crys in crystallineTypes">
                        <label>
                      <input type="checkbox" ng-model="crysCheckboxes[crys]" analytics-on="click" analytics-event="Click Supplier Type Filter: {{crys}}" ng-change="updateFilter()">
                      <span><small>{{crys}}</small></span>
                    </label>
                    </li>
                </div>

                <div class="list-group">
                    <span class="catalog-label"><small>Frame Color ></small></span>
                    <li ng-repeat="color in frameColors">
                        <label>
                      <input type="checkbox" ng-model="fColorCheckboxes[color]" analytics-on="click" analytics-event="Click Frame Color Filter: {{color}}" ng-change="updateFilter()">
                      <span><small>{{color}}</small></span>
                    </label>
                    </li>
                </div>

                <div class="list-group">
                    <span class="catalog-label"><small>Number of Cells ></small></span>
                    <li ng-repeat="cells in numberOfCells">
                        <label>
                      <input type="checkbox" ng-model="numCellsCheckboxes[cells]" analytics-on="click" analytics-event="Click Number of Cells Filter: {{cells}}" ng-change="updateFilter()">
                      <span><small>{{cells}}</small></span>
                    </label>
                    </li>
                </div>
              <!-- <div class="list-group">
                  <span class="catalog-label"><small>Module Wattage ></small></span>
                  <li ng-repeat="range in ranges">
                    <label>
                      <input type="checkbox" ng-model="wattCheckboxes[range]" ng-change="updateFilter()">
                      <span><small>{{range}}</small></span>
                    </label>
                  </li>
              </div> -->
                <div class="list-group">
                    <span class="catalog-label"><small>Brand ></small></span>
                    <li ng-repeat="man in manufacturers">
                        <label>
                      <input type="checkbox" ng-model="orgCheckboxes[man]" analytics-on="click" analytics-event="Click Brand Filter: {{man}}" ng-change="updateFilter()">
                      <span><small>{{man}}</small></span>
                    </label>
                    </li>
                </div>
            </div>

            <div class="horizontal list-group col-sm-7">
                <div class="alert alert-warning text-center" ng-if="resolvedResources === expectedResources && !orgs.length">
                    No search results
                </div>
                <div>
                    <pagination ng-show="totalCount" boundary-links="true" max-size="8" items-per-page="itemsPerPage" total-items="totalCount" ng-model="currentPage" ng-change="pageChanged()"></pagination>
                </div>
                <div ng-repeat="organization in orgs" class="list-group-item col-sm-12">
                    <a ng-click="routeToOrg(organization._id)">
                      <img class="company-logo" ng-src="{{organization.logoImageUrl}}">
                    </a>
                    <div class="profile-info">
                        <a ng-click="routeToOrg(organization._id)">
                        <div>
                            <h5 class="list-group-item-heading" ng-bind="organization.companyName"></h5>

                        <div class="reviews">
                            <rating ng-model="organization.avg_review" readonly="true" on-hover="" aria-labelledby="default-rating"></rating>
                            <span>{{organization.reviews_length}} reviews</span>
                        </div>
                        <div class="detail">
                            <small><span class="glyphicon glyphicon-map-marker"></span><span ng-bind="organization.address1"></span> <span ng-bind="organization.address2"></span>, <span ng-bind="organization.city"></span>, <span ng-bind="organization.state"></span> <span ng-bind="organization.zipcode"></span> <span ng-bind="organization.country"></span></small><br>
                        </div>
                        </a>
                        </div>
                        <div class="menu">
                            <a ng-if="organization._id !== authentication.user.organization" ng-click="contactSupplier($event, organization)">
                                <span class="glyphicon glyphicon-envelope"></span><span>Contact seller</span>
                            </a>
                            <a ng-if="organization._id !== authentication.user.organization" ng-click="followOrganization($event, organization)">
                                <span class=""></span><span>
                                  {{(!emailNotification.followingOrganizations || emailNotification.followingOrganizations.indexOf(organization._id) === -1) ?
                                        ('Follow') : ('Following')
                                  }}</span>
                            </a>
                        </div>

                        <div class="brand-list">
                            <table>
                                <tr class="header">

                                    <td ng-show="organization.panel_crystalline_types.indexOf('Poly') !== -1">
                                        <div class="img-wrapper">
                                          <span class="helper"></span>
                                          <img src="/modules/core/client/img/asset/poly-module.jpg">
                                        </div>
                                        <div class="category">
                                          <small>Polycrystalline Module</small>
                                          <div><small>(USD per watt)</small></div>
                                        </div>
                                    </td>
                                    <td ng-show="organization.panel_crystalline_types.indexOf('Mono') !== -1">
                                        <div class="img-wrapper">
                                          <span class="helper"></span>
                                          <img src="/modules/core/client/img/asset/mono-module.jpg">
                                        </div>
                                        <div class="category">
                                          <small>Monocrystalline Module</small>
                                          <div><small>(USD per watt)</small></div>
                                        </div>
                                    </td>
                                </tr>
                                <tr ng-repeat="brand in organization.manufacturers" ng-show="!query.man || query.man.indexOf(brand) !== -1" class="line-item">
                                    <td ng-show="organization.panel_crystalline_types.indexOf('Poly') !== -1">
                                        <span ng-bind="organization.brands[brand+'#Poly'] ? (organization.brands[brand+'#Poly']/100 | currency): 'no quotes'" class="price"></span><br>
                                        <span><small>{{brand}}</small></span>
                                    </td>
                                    <td ng-show="organization.panel_crystalline_types.indexOf('Mono') !== -1">
                                        <span ng-bind="organization.brands[brand+'#Mono'] ? (organization.brands[brand+'#Mono']/100 | currency): 'no quotes'" class="price"></span><br>
                                        <span><small>{{brand}}</small></span>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div>
                    <pagination ng-show="totalCount" boundary-links="true" max-size="8" items-per-page="itemsPerPage" total-items="totalCount" ng-model="currentPage" ng-change="pageChanged()"></pagination>
                </div>
            </div>
        </section>
    </div>
</section>
